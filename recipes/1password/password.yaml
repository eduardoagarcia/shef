recipes:
  - name: "password"
    description: "Get the password from an item in 1Password"
    category: "op"
    operations:
      - id: "item"
        uses: "op.item.select"
        with:
          filter: "{{ .input }}"

      - id: "password"
        command: op item get "{{ .item }}" --fields label=password --reveal
        silent: true
        cleanup:
          - "item"

      - uses: "op.lock"

      - uses: "clipboard.copy"
        with:
          value: "{{ .password }}"

      - cleanup:
          - "password"

  - name: "otp"
    description: "Get the one time password from an item in 1Password"
    category: "op"
    operations:
      - id: "item"
        uses: "op.item.select"
        with:
          filter: "{{ .input }}"

      - id: "password"
        command: op item get "{{ .item }}" --format json | jq '.fields[] | select(.type == "OTP") | .totp'
        silent: true
        cleanup:
          - "item"

      - uses: "op.lock"

      - uses: "clipboard.copy"
        with:
          value: "{{ .password }}"

      - cleanup:
          - "password"

  - name: "item"
    description: "Get an item in 1Password"
    category: "op"
    operations:
      - id: "item"
        uses: "op.item.select"
        with:
          filter: "{{ .input }}"

      - id: "item"
        command: op item get "{{ .item }}"
        cleanup:
          - "item"

      - uses: "op.lock"
